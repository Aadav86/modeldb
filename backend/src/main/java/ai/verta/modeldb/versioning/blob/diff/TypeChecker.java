package ai.verta.modeldb.versioning.blob.diff;

import ai.verta.modeldb.versioning.autogenerated._public.modeldb.versioning.model.Blob;

public class TypeChecker {
  public static String getType(Blob b) {
    if (b == null) {
      return "null";
    } else {
      if (b.Dataset.isPresent()) {
        if (b.Dataset.get().Path.isPresent()) {
          return "DatasetPath";
        }
        if (b.Dataset.get().S3.isPresent()) {
          return "DatasetS3";
        }
        return "DatasetUnknown";
      }
      if (b.Config.isPresent()) {
        return "Config";
      }
      if (b.Environment.isPresent()) {
        if (b.Environment.get().Docker.isPresent()) {
          return "EnvironmentDocker";
        }
        if (b.Environment.get().Python.isPresent()) {
          return "EnvironmentPython";
        }
        return "EnvironmentUnknown";
      }
      if (b.Code.isPresent()) {
        if (b.Code.get().Git.isPresent()) {
          return "CodeGit";
        }
        if (b.Code.get().Notebook.isPresent()) {
          return "CodeNotebook";
        }
        return "CodeUnknown";
      }
      return "Unknown";
    }
  }

  public static Boolean sameType(Blob a, Blob b) {
    return getType(a).equals(getType(b));
  }
}
